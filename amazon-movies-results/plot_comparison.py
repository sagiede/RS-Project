import matplotlib.pyplot as plt
import seaborn as sns
import numpy as np
if __name__ == '__main__':
    # fig ,ax = plt.subplots(figsize = (14,8))
    rmse_ucfn = [1.0621919631958008, 1.0407211780548096, 1.0280086994171143, 1.021931529045105, 1.018636703491211, 1.0170128345489502, 1.0158069133758545, 1.0152746438980103, 1.0158692598342896, 1.0160692930221558, 1.0167553424835205, 1.0166765451431274, 1.0168805122375488, 1.0172418355941772, 1.0176985263824463, 1.0181525945663452, 1.0186289548873901, 1.018709659576416, 1.0191521644592285, 1.0190935134887695, 1.0194023847579956, 1.019887924194336, 1.0202008485794067, 1.0203025341033936, 1.0204840898513794]
    rmse_ucfnpp = [1.0649464130401611, 1.0457473993301392, 1.032967448234558, 1.0249099731445312, 1.0206118822097778, 1.0183809995651245, 1.0169179439544678, 1.0163499116897583, 1.0157194137573242, 1.0156433582305908, 1.0155411958694458, 1.0156842470169067, 1.0160177946090698, 1.0164260864257812, 1.0166243314743042, 1.0170698165893555, 1.0170563459396362, 1.0174870491027832, 1.0176185369491577, 1.018114447593689, 1.0184687376022339, 1.0186197757720947, 1.019349217414856, 1.0192996263504028, 1.0194560289382935]
    rmse_ucfnas = [1.105029582977295, 1.0670990943908691, 1.0454014539718628, 1.0323600769042969, 1.0249565839767456, 1.0209697484970093, 1.0183112621307373, 1.017480731010437, 1.0185571908950806, 1.0170249938964844, 1.016679048538208, 1.017033576965332, 1.0177314281463623, 1.0174928903579712, 1.0181550979614258, 1.0190578699111938, 1.0189458131790161, 1.019079327583313, 1.0188817977905273, 1.0195903778076172, 1.0203156471252441, 1.019602656364441, 1.020418405532837, 1.0207626819610596, 1.020487904548645]
    # sns.lineplot(np.arange(200), rmse_ucfn, label="U-CFN", ax=ax)
    # sns.lineplot(np.arange(200), rmse_ucfnpp, label="U-CFN-++", ax=ax)
    # sns.lineplot(np.arange(200), rmse_ucfnas, label="U-CFN-*", ax=ax)
    # min_val = min(min(rmse_ucfn), min(rmse_ucfnpp), min(rmse_ucfnas))
    # sns.lineplot(np.arange(200), [min_val] * 200, label="Min-RMSE", ax=ax)
    # ax.set_title("Test-RMSE - Amazon Video Games")
    # ax.set_xlabel("Epoch")
    # ax.set_ylabel("RMSE")
    # plt.figure(figsize=(14, 8))
    # plt.savefig("u-cfn-comparison.png")
    # plt.show()
    #
    # fig ,ax = plt.subplots(figsize = (14,8))
    rmse_icfn = [1.0730332136154175, 1.049417495727539, 1.0351415872573853, 1.026582956314087, 1.0217489004135132, 1.0190719366073608, 1.017341136932373, 1.016687273979187, 1.0169237852096558, 1.0166735649108887, 1.0171929597854614, 1.0177825689315796, 1.018082618713379, 1.0185470581054688, 1.0192465782165527, 1.019941806793213, 1.020606517791748, 1.020857572555542, 1.0212420225143433, 1.021764874458313, 1.0222986936569214, 1.0219624042510986, 1.0225474834442139, 1.0228685140609741, 1.0231677293777466]
    rmse_icfnpp = [1.0775911808013916, 1.0560559034347534, 1.0415695905685425, 1.0322223901748657, 1.025915265083313, 1.022143840789795, 1.019632339477539, 1.01816725730896, 1.0175182819366455, 1.0174086093902588, 1.01680326461792, 1.0170120000839233, 1.0172739028930664, 1.0176432132720947, 1.0182074308395386, 1.018839716911316, 1.019161581993103, 1.0194916725158691, 1.020065188407898, 1.020530343055725, 1.0211894512176514, 1.021443247795105, 1.0213764905929565, 1.0216017961502075, 1.021788477897644]
    rmse_icfnas = [1.1216375827789307, 1.0945619344711304, 1.0673136711120605, 1.0507392883300781, 1.0388803482055664, 1.0319193601608276, 1.0270634889602661, 1.0238012075424194, 1.0219279527664185, 1.0210753679275513, 1.0214492082595825, 1.0206977128982544, 1.0210790634155273, 1.0210870504379272, 1.0219745635986328, 1.0218230485916138, 1.0225059986114502, 1.022843599319458, 1.0235580205917358, 1.0240073204040527, 1.024005651473999, 1.0244054794311523, 1.0245436429977417, 1.0242886543273926, 1.0239372253417969]
    # sns.lineplot(np.arange(200), rmse_icfn, label="I-CFN", ax=ax)
    # sns.lineplot(np.arange(200), rmse_icfnpp, label="I-CFN-++", ax=ax)
    # sns.lineplot(np.arange(200), rmse_icfnas, label="I-CFN-*", ax=ax)
    # min_val = min(min(rmse_icfn), min(rmse_icfnpp), min(rmse_icfnas))
    # sns.lineplot(np.arange(200), [min_val] * 200, label="Min-RMSE", ax=ax)
    # ax.set_title("Test-RMSE")
    # ax.set_xlabel("Epoch")
    # ax.set_ylabel("RMSE")
    # plt.savefig("i-cfn-comparison.png")
    # plt.show()

    fig ,ax = plt.subplots(figsize = (14,8),)
    sns.lineplot(np.arange(25), rmse_icfn, label="I-CFN", ax=ax)
    sns.lineplot(np.arange(25), rmse_icfnpp, label="I-CFN-++", ax=ax)
    sns.lineplot(np.arange(25), rmse_icfnas, label="I-CFN-*", ax=ax)
    sns.lineplot(np.arange(25), rmse_ucfn, label="U-CFN", ax=ax)
    sns.lineplot(np.arange(25), rmse_ucfnpp, label="U-CFN-++", ax=ax)
    sns.lineplot(np.arange(25), rmse_ucfnas, label="U-CFN-*", ax=ax)

    min_val = min(min(rmse_ucfn), min(rmse_ucfnpp), min(rmse_ucfnas),
                  min(rmse_icfn), min(rmse_icfnpp), min(rmse_icfnas))

    sns.lineplot(np.arange(25), [min_val] * 25, label="Min-RMSE", ax=ax)
    sns.lineplot(np.arange(25), [1.0453] * 25, label="Popularity", ax=ax)
    ax.lines[6].set_linestyle("--")
    ax.lines[7].set_linestyle("--")
    ax.set_title("Test-RMSE - Amazon Video Games")
    ax.set_xlabel("Epoch")
    ax.set_ylabel("RMSE")
    plt.savefig("amazon-i-u-cfn-comparison.png")
    plt.show()


    cold_rmse_icfn = [1.1221226453781128, 1.1022597551345825, 1.090046763420105, 1.083551049232483, 1.0794662237167358, 1.0784573554992676, 1.0776441097259521, 1.078061580657959, 1.078366756439209, 1.07947838306427, 1.0808730125427246, 1.0819426774978638, 1.0831282138824463, 1.0839552879333496, 1.0845482349395752, 1.085715889930725, 1.0868254899978638, 1.0877567529678345, 1.088086724281311, 1.0887492895126343, 1.0900540351867676, 1.0900861024856567, 1.0906956195831299, 1.0911767482757568, 1.091452717781067]
    cold_rmse_icfnpp = [1.131718397140503, 1.1127872467041016, 1.1004973649978638, 1.0922962427139282, 1.0870088338851929, 1.084228754043579, 1.0824600458145142, 1.0811150074005127, 1.080844759941101, 1.080957293510437, 1.080983281135559, 1.0811365842819214, 1.081577181816101, 1.0823441743850708, 1.0833097696304321, 1.083925485610962, 1.0842500925064087, 1.084564208984375, 1.0855433940887451, 1.0859460830688477, 1.0871676206588745, 1.087455153465271, 1.0873944759368896, 1.0883501768112183, 1.0890822410583496]
    cold_rmse_icfnas = [1.1841199398040771, 1.1539705991744995, 1.1256223917007446, 1.1089950799942017, 1.097051739692688, 1.090218424797058, 1.086069941520691, 1.0848709344863892, 1.0819470882415771, 1.0821419954299927, 1.0821276903152466, 1.0832085609436035, 1.0835576057434082, 1.084088921546936, 1.0848513841629028, 1.0851895809173584, 1.0864940881729126, 1.0874693393707275, 1.087636113166809, 1.0870423316955566, 1.0895346403121948, 1.0896100997924805, 1.0895086526870728, 1.089091420173645, 1.0897821187973022]
    cold_rmse_ucfn = [1.0690550804138184, 1.0492926836013794, 1.0394039154052734, 1.034759283065796, 1.0322239398956299, 1.0308499336242676, 1.0313191413879395, 1.031913161277771, 1.032209873199463, 1.0334068536758423, 1.0340869426727295, 1.0345792770385742, 1.0351228713989258, 1.0354201793670654, 1.0362728834152222, 1.0366545915603638, 1.0370594263076782, 1.038745641708374, 1.0389552116394043, 1.0389126539230347, 1.0398014783859253, 1.03908109664917, 1.0394402742385864, 1.03932523727417, 1.0388976335525513]
    cold_rmse_ucfnpp = [1.0706104040145874, 1.052709937095642, 1.0433309078216553, 1.0367826223373413, 1.0337458848953247, 1.0318158864974976, 1.0310747623443604, 1.0306674242019653, 1.0310841798782349, 1.0315901041030884, 1.0328480005264282, 1.0332480669021606, 1.0337318181991577, 1.0342210531234741, 1.034478783607483, 1.0348975658416748, 1.035463571548462, 1.0352821350097656, 1.0364456176757812, 1.036543369293213, 1.0369625091552734, 1.037459135055542, 1.0380464792251587, 1.03835928440094, 1.0381906032562256]
    cold_rmse_ucfnas = [1.1435497999191284, 1.104110836982727, 1.0779755115509033, 1.0612789392471313, 1.0497891902923584, 1.044791579246521, 1.041410207748413, 1.0380123853683472, 1.0370254516601562, 1.0371761322021484, 1.0359312295913696, 1.0357707738876343, 1.0373461246490479, 1.0378270149230957, 1.0384242534637451, 1.0376572608947754, 1.0380709171295166, 1.0380650758743286, 1.0386459827423096, 1.0381934642791748, 1.0395169258117676, 1.0390130281448364, 1.0404857397079468, 1.0400298833847046, 1.0398471355438232]

    fig ,ax = plt.subplots(figsize = (14,8),)
    sns.lineplot(np.arange(25), cold_rmse_icfn, label="I-CFN", ax=ax)
    sns.lineplot(np.arange(25), cold_rmse_icfnpp, label="I-CFN-++", ax=ax)
    sns.lineplot(np.arange(25), cold_rmse_icfnas, label="I-CFN-*", ax=ax)
    sns.lineplot(np.arange(25), cold_rmse_ucfn, label="U-CFN", ax=ax)
    sns.lineplot(np.arange(25), cold_rmse_ucfnpp, label="U-CFN-++", ax=ax)
    sns.lineplot(np.arange(25), cold_rmse_ucfnas, label="U-CFN-*", ax=ax)
    min_val = min(min(cold_rmse_ucfn), min(cold_rmse_ucfnpp), min(cold_rmse_ucfnas),
                  min(cold_rmse_icfn), min(cold_rmse_icfnpp), min(cold_rmse_icfnas))
    sns.lineplot(np.arange(25), [min_val] * 25, label="Min-RMSE", ax=ax)
    sns.lineplot(np.arange(25), [1.054] * 25, label="Popularity", ax=ax)
    ax.lines[6].set_linestyle("--")
    ax.lines[7].set_linestyle("--")
    ax.set_title("Test-RMSE Cold ratings - Amazon Video Games")
    ax.set_xlabel("Epoch")
    ax.set_ylabel("RMSE")
    plt.savefig("cold-amazon-i-u-cfn-comparison.png")
    plt.show()



    # fig ,ax = plt.subplots(figsize = (14,8),)
    # sns.lineplot(np.arange(200), cold_rmse_ucfn, label="U-CFN", ax=ax)
    # sns.lineplot(np.arange(200), cold_rmse_ucfnpp, label="U-CFN-++", ax=ax)
    # sns.lineplot(np.arange(200), cold_rmse_ucfnas, label="U-CFN-*", ax=ax)
    # min_val = min(min(cold_rmse_ucfn), min(cold_rmse_ucfnpp), min(cold_rmse_ucfnas))
    # sns.lineplot(np.arange(200), [min_val] * 200, label="Min-RMSE", ax=ax)
    # ax.set_title("Test-RMSE Cold ratings")
    # ax.set_xlabel("Epoch")
    # ax.set_ylabel("RMSE")
    # plt.savefig("cold-u-cfn-comparison.png")
    # plt.show()

    # fig ,ax = plt.subplots(figsize = (14,8),)
    # sns.lineplot(np.arange(200), cold_rmse_icfn, label="I-CFN", ax=ax)
    # sns.lineplot(np.arange(200), cold_rmse_icfnpp, label="I-CFN-++", ax=ax)
    # sns.lineplot(np.arange(200), cold_rmse_icfnas, label="I-CFN-*", ax=ax)
    # min_val = min(min(cold_rmse_icfn), min(cold_rmse_icfnpp), min(cold_rmse_icfnas))
    # sns.lineplot(np.arange(200), [min_val] * 200, label="Min-RMSE", ax=ax)
    # ax.set_title("Test-RMSE Cold ratings")
    # ax.set_xlabel("Epoch")
    # ax.set_ylabel("RMSE")
    # plt.savefig("cold-i-cfn-comparison.png")
    # plt.show()