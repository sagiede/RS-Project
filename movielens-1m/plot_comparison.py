import matplotlib.pyplot as plt
import seaborn as sns
import numpy as np
if __name__ == '__main__':
    fig ,ax = plt.subplots(figsize = (14,8))
    rmse_ucfn = [0.9403478503227234, 0.9342467784881592, 0.9329461455345154, 0.9332765936851501, 0.9336981177330017, 0.9343119263648987, 0.9326149821281433, 0.933687686920166, 0.9317406415939331, 0.9304907321929932, 0.9297550916671753, 0.9272907376289368, 0.9260779619216919, 0.9254288077354431, 0.9242218136787415, 0.921472430229187, 0.9225679039955139, 0.9195753335952759, 0.9173624515533447, 0.9161569476127625, 0.9147177934646606, 0.9142279028892517, 0.9133824110031128, 0.9134436845779419, 0.9116619229316711, 0.9098184704780579, 0.9101528525352478, 0.9098225235939026, 0.9093815684318542, 0.9097102284431458, 0.9080076217651367, 0.9084595441818237, 0.9067704677581787, 0.9081302285194397, 0.9055214524269104, 0.904002845287323, 0.9053089022636414, 0.9028251767158508, 0.9039120078086853, 0.9030133485794067, 0.9013434052467346, 0.8999884128570557, 0.9000992774963379, 0.8991215825080872, 0.9005668759346008, 0.8999236822128296, 0.8985201120376587, 0.8975589275360107, 0.8969021439552307, 0.8990683555603027, 0.8987582921981812, 0.8960697650909424, 0.8970061540603638, 0.8947503566741943, 0.896582841873169, 0.894760012626648, 0.8948729634284973, 0.8958250284194946, 0.8947731256484985, 0.8945640921592712, 0.8931821584701538, 0.893121600151062, 0.8931998610496521, 0.8920667767524719, 0.8916558623313904, 0.8932313919067383, 0.8942287564277649, 0.8919998407363892, 0.8934115767478943, 0.8915541768074036, 0.8909928202629089, 0.8928692936897278, 0.8905821442604065, 0.890733003616333, 0.8897308111190796, 0.8900312781333923, 0.8910162448883057, 0.8894769549369812, 0.8909198045730591, 0.8913351893424988, 0.889670729637146, 0.8889535069465637, 0.8915355801582336, 0.888908326625824, 0.890296220779419, 0.88968425989151, 0.8880206942558289, 0.8889359831809998, 0.890300989151001, 0.8897058963775635, 0.888056755065918, 0.8894392251968384, 0.8872131705284119, 0.8865277767181396, 0.889159083366394, 0.8894768357276917, 0.8886065483093262, 0.8875935077667236, 0.8891990184783936, 0.887626588344574, 0.8868937492370605, 0.888168454170227, 0.8883740305900574, 0.8887636065483093, 0.8880121111869812, 0.8889720439910889, 0.8905646204948425, 0.8866655826568604, 0.8865891695022583, 0.8873102068901062, 0.8861045837402344, 0.8865852952003479, 0.888582706451416, 0.8866355419158936, 0.8872814774513245, 0.8868420124053955, 0.8867505788803101, 0.8858939409255981, 0.887553334236145, 0.886328935623169, 0.8859732151031494, 0.8861294388771057, 0.8878738284111023, 0.8855550289154053, 0.8866323232650757, 0.8849500417709351, 0.8859388828277588, 0.8877959847450256, 0.8868319392204285, 0.8860632181167603, 0.8854431509971619, 0.8880810737609863, 0.8871580362319946, 0.8861837983131409, 0.8844252824783325, 0.8853386044502258, 0.885297417640686, 0.8858838081359863, 0.885967493057251, 0.8847338557243347, 0.8847934603691101, 0.8846851587295532, 0.8861268162727356, 0.8860400915145874, 0.8855908513069153, 0.885076642036438, 0.8863652944564819, 0.8865660429000854, 0.8860369324684143, 0.8843698501586914, 0.8858779072761536, 0.8851078152656555, 0.8858852982521057, 0.8848829865455627, 0.8857259154319763, 0.8869783878326416, 0.8855547904968262, 0.8848392963409424, 0.8843392729759216, 0.8833810687065125, 0.8839530944824219, 0.8846869468688965, 0.8844813704490662, 0.8844985961914062, 0.8840771913528442, 0.885471522808075, 0.8848125338554382, 0.8858133554458618, 0.8839758038520813, 0.8853891491889954, 0.8856428861618042, 0.8845751881599426, 0.8849936723709106, 0.8844967484474182, 0.8856506943702698, 0.8866987228393555, 0.8853557705879211, 0.8841273784637451, 0.8835066556930542, 0.8837684392929077, 0.8837695717811584, 0.8839778900146484, 0.884191632270813, 0.8866194486618042, 0.8846194744110107, 0.8847207427024841, 0.8825196027755737, 0.8850407004356384, 0.8833454251289368, 0.884015679359436, 0.8839419484138489, 0.8850530982017517, 0.8847341537475586, 0.8842797875404358, 0.8843703269958496, 0.8823906183242798, 0.8836517930030823, 0.8831735253334045, 0.8847132921218872, 0.885235607624054]
    rmse_ucfnpp = [0.9393340349197388, 0.9338452219963074, 0.933364987373352, 0.9331393241882324, 0.9325173497200012, 0.9323087930679321, 0.9316915273666382, 0.9321855902671814, 0.9298927783966064, 0.9301828742027283, 0.9280027151107788, 0.9272226691246033, 0.9253635406494141, 0.9225390553474426, 0.9200827479362488, 0.9198680520057678, 0.9187684059143066, 0.9155578017234802, 0.9136634469032288, 0.9115287661552429, 0.9113349318504333, 0.9108832478523254, 0.9106676578521729, 0.9106686115264893, 0.9080209732055664, 0.9082412123680115, 0.9062290787696838, 0.9087408781051636, 0.9051586985588074, 0.9049022197723389, 0.9043145775794983, 0.9054612517356873, 0.9053213000297546, 0.9030855298042297, 0.9028391242027283, 0.900645911693573, 0.9006255269050598, 0.8993467092514038, 0.9019973278045654, 0.8988368511199951, 0.8991336822509766, 0.8975216746330261, 0.8960248827934265, 0.8980055451393127, 0.896263837814331, 0.8956037759780884, 0.8956554532051086, 0.8958395719528198, 0.8939006328582764, 0.8946004509925842, 0.8928205966949463, 0.893426239490509, 0.8928839564323425, 0.8928561210632324, 0.8936942219734192, 0.8922057747840881, 0.8932307362556458, 0.8917924165725708, 0.8905355930328369, 0.8919345736503601, 0.8925365805625916, 0.8909515738487244, 0.8906095027923584, 0.8906485438346863, 0.889708936214447, 0.889329195022583, 0.8900138139724731, 0.8902735710144043, 0.8912246823310852, 0.8908572793006897, 0.8900461196899414, 0.8910413980484009, 0.8910565972328186, 0.8901317119598389, 0.8891626596450806, 0.8887835741043091, 0.890779972076416, 0.8892532587051392, 0.8925815224647522, 0.8893617987632751, 0.8887333273887634, 0.888026773929596, 0.8900028467178345, 0.8878902196884155, 0.8896457552909851, 0.8880637884140015, 0.8896648287773132, 0.8875353336334229, 0.8877001404762268, 0.8882308006286621, 0.8871326446533203, 0.8862998485565186, 0.8869753479957581, 0.8897451758384705, 0.8883872032165527, 0.8884628415107727, 0.8885025978088379, 0.8876913785934448, 0.8863492012023926, 0.8851513266563416, 0.888227641582489, 0.8859955668449402, 0.8892370462417603, 0.8861432671546936, 0.8853452801704407, 0.8861401081085205, 0.8867399096488953, 0.8866815567016602, 0.8866411447525024, 0.8867725729942322, 0.8855146765708923, 0.8857646584510803, 0.8865346908569336, 0.887216329574585, 0.8864373564720154, 0.8858225345611572, 0.8847444653511047, 0.886549711227417, 0.8874348402023315, 0.886640191078186, 0.8876000046730042, 0.886020839214325, 0.8860276341438293, 0.8851636648178101, 0.8847812414169312, 0.8854534029960632, 0.886623740196228, 0.8845418691635132, 0.8857894539833069, 0.8867570757865906, 0.8848446607589722, 0.886265218257904, 0.8856416940689087, 0.887084424495697, 0.8862998485565186, 0.8862718343734741, 0.8870378136634827, 0.8861796855926514, 0.8849558234214783, 0.8883070945739746, 0.8852078914642334, 0.8863623142242432, 0.8851909041404724, 0.8852300047874451, 0.8863716125488281, 0.8844718337059021, 0.8861787915229797, 0.8853166103363037, 0.8856253623962402, 0.8856484293937683, 0.8867096900939941, 0.8868885040283203, 0.8861151337623596, 0.8845006823539734, 0.8866252899169922, 0.8850170373916626, 0.8838959336280823, 0.8860079646110535, 0.8864092826843262, 0.884233295917511, 0.8840122818946838, 0.8834782838821411, 0.8854666948318481, 0.8860349059104919, 0.8853877186775208, 0.8842992782592773, 0.8862272500991821, 0.8863740563392639, 0.8859078288078308, 0.8862783312797546, 0.885980486869812, 0.8846545219421387, 0.8850658535957336, 0.8865633606910706, 0.8858930468559265, 0.8851255178451538, 0.8844103813171387, 0.8850834965705872, 0.8865185976028442, 0.8863591551780701, 0.8848502039909363, 0.8848481774330139, 0.8854250311851501, 0.8852682113647461, 0.8850091099739075, 0.8836228251457214, 0.8847628235816956, 0.8863512277603149, 0.8850903511047363, 0.8841343522071838, 0.8859692811965942, 0.8844227194786072, 0.8846015930175781, 0.8865284323692322, 0.8863258361816406, 0.8843360543251038, 0.8847635984420776, 0.8840148448944092, 0.8857190608978271, 0.8866416811943054]
    rmse_ucfnas = [1.1192951202392578, 1.0149017572402954, 0.9938638210296631, 0.9688350558280945, 0.9565577507019043, 0.9577634334564209, 0.9576917886734009, 0.959320604801178, 0.9473733305931091, 0.9545424580574036, 0.9480936527252197, 0.9460764527320862, 0.9467539191246033, 0.9419803023338318, 0.9430838823318481, 0.9424322247505188, 0.9395402073860168, 0.9428148865699768, 0.9390741586685181, 0.9395908713340759, 0.9359631538391113, 0.9375963807106018, 0.9378252029418945, 0.9378809928894043, 0.9391406178474426, 0.9357869625091553, 0.9331966042518616, 0.9319736957550049, 0.9327784776687622, 0.9318087697029114, 0.9337315559387207, 0.9308426380157471, 0.9295191764831543, 0.9278070330619812, 0.9280901551246643, 0.92640620470047, 0.9273091554641724, 0.9269196391105652, 0.9269105792045593, 0.9228819012641907, 0.9262770414352417, 0.9264655709266663, 0.9224802851676941, 0.9222833514213562, 0.9213725924491882, 0.9235830307006836, 0.9219887256622314, 0.9205803275108337, 0.9223108887672424, 0.9209023118019104, 0.9200634360313416, 0.91966712474823, 0.916822075843811, 0.9294755458831787, 0.9174060821533203, 0.9161424040794373, 0.915570080280304, 0.9167724847793579, 0.9149508476257324, 0.9157575964927673, 0.9133954644203186, 0.9128540754318237, 0.910506546497345, 0.9112692475318909, 0.9119142889976501, 0.9128040671348572, 0.9106334447860718, 0.9118670225143433, 0.9139615297317505, 0.9106597304344177, 0.9090045094490051, 0.909262478351593, 0.9100721478462219, 0.9108173847198486, 0.9085332751274109, 0.9073434472084045, 0.907832145690918, 0.9052239060401917, 0.9073502421379089, 0.9047086238861084, 0.9032456278800964, 0.9056938290596008, 0.9075750112533569, 0.9072327017784119, 0.903651773929596, 0.9049162268638611, 0.9033418893814087, 0.9043646454811096, 0.9021304845809937, 0.903261125087738, 0.9043367505073547, 0.903302788734436, 0.9020033478736877, 0.9018930792808533, 0.9007933139801025, 0.902021050453186, 0.9016844630241394, 0.9021236300468445, 0.9031506180763245, 0.8998782634735107, 0.900046169757843, 0.9008055925369263, 0.8981824517250061, 0.8982660174369812, 0.8980010151863098, 0.8971737027168274, 0.8987669348716736, 0.8988847732543945, 0.8980962634086609, 0.89686119556427, 0.8970476984977722, 0.8979097008705139, 0.8956082463264465, 0.8973556160926819, 0.8972920775413513, 0.895476758480072, 0.8947842121124268, 0.8952868580818176, 0.8975780606269836, 0.8979933857917786, 0.8972892165184021, 0.8958498239517212, 0.8976181745529175, 0.8966229557991028, 0.8997564911842346, 0.899415910243988, 0.894389271736145, 0.8965438604354858, 0.894725501537323, 0.8952422738075256, 0.8952653408050537, 0.897345244884491, 0.8942924737930298, 0.8974466323852539, 0.8949244618415833, 0.8952959179878235, 0.8956065773963928, 0.8928194642066956, 0.8924866318702698, 0.8932783603668213, 0.8929736614227295, 0.8957560658454895, 0.8926708698272705, 0.8914499878883362, 0.892724871635437, 0.8923001885414124, 0.8966647982597351, 0.8937014937400818, 0.8924263119697571, 0.8924880027770996, 0.891599714756012, 0.8916541337966919, 0.8951282501220703, 0.8940123319625854, 0.8909623622894287, 0.8924915194511414, 0.8942419290542603, 0.8931882381439209, 0.8907583355903625, 0.8994101881980896, 0.8927195072174072, 0.8925293684005737, 0.8919132947921753, 0.8924440741539001, 0.8905752301216125, 0.8915166854858398, 0.8955323696136475, 0.8898274898529053, 0.8929568529129028, 0.8903119564056396, 0.8910696506500244, 0.8904051184654236, 0.8914119601249695, 0.8906906247138977, 0.8910609483718872, 0.8916960954666138, 0.8898724317550659, 0.8927043080329895, 0.8911297917366028, 0.8932855129241943, 0.8929423093795776, 0.8890178203582764, 0.8970443606376648, 0.8902833461761475, 0.8900729417800903, 0.8911756873130798, 0.8893051743507385, 0.8872630596160889, 0.8910477757453918, 0.8890925049781799, 0.8906111121177673, 0.8907080888748169, 0.8893578052520752, 0.8921416401863098, 0.8918991684913635, 0.8894488215446472, 0.8913499116897583, 0.8968901038169861, 0.8904094696044922, 0.8883351683616638]
    sns.lineplot(np.arange(200), rmse_ucfn, label="U-CFN", ax=ax)
    sns.lineplot(np.arange(200), rmse_ucfnpp, label="U-CFN-++", ax=ax)
    sns.lineplot(np.arange(200), rmse_ucfnas, label="U-CFN-*", ax=ax)
    min_val = min(min(rmse_ucfn), min(rmse_ucfnpp), min(rmse_ucfnas))
    sns.lineplot(np.arange(200), [min_val] * 200, label="Min-RMSE", ax=ax)
    ax.set_title("Test-RMSE")
    ax.set_xlabel("Epoch")
    ax.set_ylabel("RMSE")
    plt.figure(figsize=(14, 8))
    plt.savefig("u-cfn-comparison.png")
    plt.show()

    fig ,ax = plt.subplots(figsize = (14,8))
    rmse_icfn = [0.9401465654373169, 0.9330369234085083, 0.9318696856498718, 0.9315027594566345, 0.9315268993377686, 0.9321483969688416, 0.9294646978378296, 0.9292845129966736, 0.9292667508125305, 0.9297085404396057, 0.9267852306365967, 0.925592839717865, 0.9230937957763672, 0.9213660359382629, 0.91871178150177, 0.9174897074699402, 0.9171866178512573, 0.9121958613395691, 0.9137752056121826, 0.9124032258987427, 0.9100042581558228, 0.9107000827789307, 0.9069586992263794, 0.9061219692230225, 0.9042109847068787, 0.9064598083496094, 0.9029995203018188, 0.9046276807785034, 0.9016343355178833, 0.9025463461875916, 0.8990431427955627, 0.8984127044677734, 0.8998538851737976, 0.8978062868118286, 0.8985859155654907, 0.895452082157135, 0.8954766392707825, 0.8953925967216492, 0.8978637456893921, 0.8936625719070435, 0.8944604992866516, 0.8939675092697144, 0.8934887647628784, 0.8906702995300293, 0.8920884728431702, 0.8913791179656982, 0.8937730193138123, 0.8909952044487, 0.8916748762130737, 0.8910908699035645, 0.8893004059791565, 0.8885204792022705, 0.8882797360420227, 0.8886765241622925, 0.8873745203018188, 0.8901368379592896, 0.8887598514556885, 0.8889082670211792, 0.8883458971977234, 0.8902382850646973, 0.8885270953178406, 0.8875088691711426, 0.8886047601699829, 0.8864266872406006, 0.8840777277946472, 0.8875689506530762, 0.8848970532417297, 0.8834847211837769, 0.8865119814872742, 0.8875954747200012, 0.8846179842948914, 0.8847373723983765, 0.8841589689254761, 0.8838734030723572, 0.8840897083282471, 0.8860854506492615, 0.8841568231582642, 0.8825589418411255, 0.8837489485740662, 0.884685218334198, 0.8842722177505493, 0.8847842812538147, 0.88265460729599, 0.8821511268615723, 0.8817862272262573, 0.8825963139533997, 0.8848974108695984, 0.8823237419128418, 0.8829354047775269, 0.8825201392173767, 0.8809659481048584, 0.8804405927658081, 0.8803883194923401, 0.8818304538726807, 0.8828943967819214, 0.8817209005355835, 0.881875216960907, 0.8832705020904541, 0.8809120655059814, 0.8822664618492126, 0.8803543448448181, 0.8801754713058472, 0.8805660009384155, 0.8799721598625183, 0.8795226216316223, 0.8804170489311218, 0.8810527920722961, 0.8815154433250427, 0.8799769282341003, 0.8803048133850098, 0.8818582892417908, 0.8810144662857056, 0.878419041633606, 0.8799123167991638, 0.879388689994812, 0.8809710741043091, 0.880513072013855, 0.8805480003356934, 0.8804274797439575, 0.8798503279685974, 0.8792020678520203, 0.877918541431427, 0.8800705671310425, 0.8778387308120728, 0.87965327501297, 0.8784759640693665, 0.8793462514877319, 0.878962516784668, 0.8771965503692627, 0.8783759474754333, 0.8770260810852051, 0.8787470459938049, 0.876628041267395, 0.8775544762611389, 0.8773409724235535, 0.8779944181442261, 0.8781805634498596, 0.8765789866447449, 0.8766844272613525, 0.8782258033752441, 0.8796032667160034, 0.8789867758750916, 0.8765197396278381, 0.8779106140136719, 0.8761938214302063, 0.8765170574188232, 0.8768817782402039, 0.8774614930152893, 0.8800272345542908, 0.8783628344535828, 0.8766108155250549, 0.8746214509010315, 0.8773649334907532, 0.8750539422035217, 0.8756679892539978, 0.875419020652771, 0.875146746635437, 0.8773959279060364, 0.8770124316215515, 0.8789870142936707, 0.8760598301887512, 0.8767499923706055, 0.8762528896331787, 0.8772273659706116, 0.8760679960250854, 0.8758379220962524, 0.8761707544326782, 0.876377522945404, 0.8767539262771606, 0.8779131174087524, 0.8743658065795898, 0.8746598958969116, 0.8755131959915161, 0.8761676549911499, 0.8752061724662781, 0.8763388991355896, 0.876883864402771, 0.877049446105957, 0.876950204372406, 0.8767201900482178, 0.87748783826828, 0.875744104385376, 0.877494752407074, 0.876059889793396, 0.8775132894515991, 0.876625657081604, 0.8764194250106812, 0.8758749961853027, 0.8774594664573669, 0.8763815760612488, 0.8724766373634338, 0.8752638697624207, 0.8769552707672119, 0.8776492476463318, 0.8756229877471924, 0.8764920830726624, 0.875531792640686, 0.8743915557861328, 0.8753101229667664, 0.8768134713172913]
    rmse_icfnpp = [0.9414545893669128, 0.9324613809585571, 0.9307137727737427, 0.9290961027145386, 0.9290568232536316, 0.9284523129463196, 0.9285266399383545, 0.9277817010879517, 0.9279704093933105, 0.9265978336334229, 0.9254624247550964, 0.9249550104141235, 0.9235023856163025, 0.9214766025543213, 0.9209663271903992, 0.9188768267631531, 0.917246401309967, 0.915204644203186, 0.9137523770332336, 0.9118315577507019, 0.9113853573799133, 0.9108133912086487, 0.9085206389427185, 0.9070726633071899, 0.9068842530250549, 0.9047335982322693, 0.9033132195472717, 0.9044378995895386, 0.9017671346664429, 0.899540364742279, 0.8995899558067322, 0.8992286324501038, 0.8991827964782715, 0.8983458280563354, 0.8977961540222168, 0.8950011134147644, 0.8948335647583008, 0.8953962326049805, 0.8935319781303406, 0.8949992656707764, 0.8936063647270203, 0.891852617263794, 0.8909711241722107, 0.891300618648529, 0.8913894295692444, 0.8909250497817993, 0.8905659914016724, 0.8892595171928406, 0.890787661075592, 0.88862544298172, 0.8877773880958557, 0.8907001614570618, 0.8874189853668213, 0.889900803565979, 0.8866534233093262, 0.8880389928817749, 0.8875731825828552, 0.8875217437744141, 0.8875226974487305, 0.8863726258277893, 0.8841409683227539, 0.8849007487297058, 0.8850087523460388, 0.8880855441093445, 0.8832892775535583, 0.8857398629188538, 0.882360577583313, 0.8830706477165222, 0.8811488151550293, 0.8865223526954651, 0.8826935291290283, 0.8827229142189026, 0.8825402855873108, 0.8849747776985168, 0.8820922374725342, 0.8834410905838013, 0.8826417326927185, 0.8819733262062073, 0.8805182576179504, 0.8839884400367737, 0.8803039193153381, 0.8813073635101318, 0.8794733285903931, 0.8811131119728088, 0.8815404772758484, 0.8797944784164429, 0.881629467010498, 0.8789399266242981, 0.8804426193237305, 0.8792925477027893, 0.8806536793708801, 0.8809694647789001, 0.8803397417068481, 0.8799455165863037, 0.8789398670196533, 0.8770221471786499, 0.8772593140602112, 0.878808856010437, 0.8770036101341248, 0.8781601786613464, 0.8776862025260925, 0.8772180080413818, 0.8780924677848816, 0.8756651282310486, 0.8759242296218872, 0.8764026761054993, 0.8771284222602844, 0.8763459324836731, 0.8786770105361938, 0.8762540817260742, 0.8772721886634827, 0.8770138025283813, 0.8770601749420166, 0.8777812719345093, 0.8746641278266907, 0.8763571977615356, 0.8765884637832642, 0.8770337104797363, 0.8780820369720459, 0.8776134252548218, 0.8761066794395447, 0.8769802451133728, 0.8781325221061707, 0.8763256072998047, 0.8747261166572571, 0.8762140274047852, 0.8774653077125549, 0.8753110766410828, 0.8753084540367126, 0.8758345246315002, 0.8743870258331299, 0.8743892312049866, 0.8760735988616943, 0.8725202083587646, 0.8750870227813721, 0.8740723729133606, 0.8731111288070679, 0.8758468627929688, 0.8735043406486511, 0.8750749230384827, 0.8749674558639526, 0.877006471157074, 0.8760402798652649, 0.873790442943573, 0.8741692304611206, 0.8734172582626343, 0.8731991052627563, 0.8747898936271667, 0.8741647601127625, 0.8738648295402527, 0.8735461235046387, 0.8720977306365967, 0.8740201592445374, 0.8723457455635071, 0.8753013014793396, 0.8735637068748474, 0.8749741911888123, 0.8728245496749878, 0.8734676837921143, 0.8719977736473083, 0.8746006488800049, 0.8747433423995972, 0.8723436594009399, 0.8706125617027283, 0.8731623291969299, 0.8730135560035706, 0.8731452226638794, 0.872186541557312, 0.8724411725997925, 0.8733049035072327, 0.8738166689872742, 0.872855007648468, 0.8731851577758789, 0.871006429195404, 0.8742417097091675, 0.8726481199264526, 0.8716155290603638, 0.8728036284446716, 0.8714520335197449, 0.8723678588867188, 0.8733735680580139, 0.8730700612068176, 0.8716738224029541, 0.8719283938407898, 0.8708339333534241, 0.8738581538200378, 0.8706194162368774, 0.8727574348449707, 0.8720401525497437, 0.8737449645996094, 0.8723726272583008, 0.8716251850128174, 0.8708266019821167, 0.8719768524169922, 0.8728339672088623, 0.8719762563705444, 0.8714868426322937, 0.8735965490341187, 0.8740842342376709, 0.8735739588737488]
    rmse_icfnas = [1.2401885986328125, 1.121920108795166, 1.0744550228118896, 0.9947891235351562, 0.9704821705818176, 0.9792554378509521, 0.9623608589172363, 0.9966089725494385, 0.9569147825241089, 0.9524471759796143, 0.952100932598114, 0.9549184441566467, 0.9477779269218445, 0.9504125714302063, 0.9458555579185486, 0.9578037858009338, 0.9479473829269409, 0.9439182877540588, 0.945517897605896, 0.9472444653511047, 0.9447859525680542, 0.9460581541061401, 0.9396487474441528, 0.9436942934989929, 0.940706193447113, 0.9365230798721313, 0.941694974899292, 0.9360532760620117, 0.9406697750091553, 0.9367318153381348, 0.9352794289588928, 0.9362915754318237, 0.93458092212677, 0.9345750212669373, 0.9360376000404358, 0.9361006617546082, 0.9350358843803406, 0.9326106309890747, 0.9325867295265198, 0.9325026273727417, 0.9320111274719238, 0.9355821013450623, 0.9332965016365051, 0.9300310611724854, 0.9318819642066956, 0.930803656578064, 0.9312124848365784, 0.9296589493751526, 0.9280733466148376, 0.9298760294914246, 0.9295384883880615, 0.9296669960021973, 0.9280074238777161, 0.9295665621757507, 0.9287530779838562, 0.9268266558647156, 0.9285866618156433, 0.9286487698554993, 0.9274040460586548, 0.927716851234436, 0.9286912083625793, 0.9294052720069885, 0.9265586137771606, 0.92616868019104, 0.9260686039924622, 0.925414502620697, 0.9245266318321228, 0.9249153733253479, 0.9253162741661072, 0.925335168838501, 0.9243053197860718, 0.924239993095398, 0.9229232668876648, 0.9235923886299133, 0.923259437084198, 0.9242603182792664, 0.9235544204711914, 0.9226621389389038, 0.9233866930007935, 0.9235421419143677, 0.9234543442726135, 0.9230973124504089, 0.922964334487915, 0.9227518439292908, 0.920335054397583, 0.9203214049339294, 0.9210131764411926, 0.9206818342208862, 0.920243501663208, 0.9195368885993958, 0.9210700392723083, 0.9194828867912292, 0.9188732504844666, 0.9196799993515015, 0.9188698530197144, 0.9194735288619995, 0.9187683463096619, 0.9181637167930603, 0.9181379079818726, 0.9188615083694458, 0.9182493090629578, 0.9170645475387573, 0.916435718536377, 0.9163293838500977, 0.9169090986251831, 0.9174596667289734, 0.9158860445022583, 0.9145187735557556, 0.9146960973739624, 0.9155582189559937, 0.9170264005661011, 0.9134730100631714, 0.9123232364654541, 0.9120301604270935, 0.9108757376670837, 0.9123531579971313, 0.9138334393501282, 0.9110285639762878, 0.9100407361984253, 0.910297155380249, 0.9093618988990784, 0.909132719039917, 0.9095065593719482, 0.9073734879493713, 0.9064261317253113, 0.9051979780197144, 0.9053162336349487, 0.9070533514022827, 0.9052660465240479, 0.9044821858406067, 0.9041934013366699, 0.903211772441864, 0.9037805199623108, 0.9035557508468628, 0.9045189619064331, 0.902657151222229, 0.9024115800857544, 0.9022005200386047, 0.9019008874893188, 0.899554431438446, 0.9003669619560242, 0.8999311327934265, 0.8985952734947205, 0.8996148705482483, 0.897655189037323, 0.9000710248947144, 0.899154007434845, 0.8982253670692444, 0.8986518383026123, 0.8961090445518494, 0.8970515131950378, 0.8951066732406616, 0.898418128490448, 0.8967036008834839, 0.895948588848114, 0.8926007747650146, 0.8941571712493896, 0.8940262794494629, 0.8933732509613037, 0.8929997682571411, 0.8916203379631042, 0.8948308229446411, 0.8930152058601379, 0.8929268717765808, 0.891139805316925, 0.8935698866844177, 0.89404296875, 0.8923788070678711, 0.8935999274253845, 0.8908669948577881, 0.8918612003326416, 0.8909145593643188, 0.8915592432022095, 0.8933513760566711, 0.8905189633369446, 0.8916521668434143, 0.89186030626297, 0.8898318409919739, 0.8890879154205322, 0.8890019655227661, 0.8901318311691284, 0.8890529274940491, 0.8887601494789124, 0.8890438079833984, 0.888074517250061, 0.8906043171882629, 0.8899281620979309, 0.8877962231636047, 0.889151930809021, 0.8895666599273682, 0.8905704617500305, 0.8875440955162048, 0.8873752355575562, 0.8854032754898071, 0.888421893119812, 0.8876121044158936, 0.8862475752830505, 0.8876379728317261, 0.8868322968482971, 0.8862807154655457]
    sns.lineplot(np.arange(200), rmse_icfn, label="I-CFN", ax=ax)
    sns.lineplot(np.arange(200), rmse_icfnpp, label="I-CFN-++", ax=ax)
    sns.lineplot(np.arange(200), rmse_icfnas, label="I-CFN-*", ax=ax)
    min_val = min(min(rmse_icfn), min(rmse_icfnpp), min(rmse_icfnas))
    sns.lineplot(np.arange(200), [min_val] * 200, label="Min-RMSE", ax=ax)
    ax.set_title("Test-RMSE")
    ax.set_xlabel("Epoch")
    ax.set_ylabel("RMSE")
    plt.savefig("i-cfn-comparison.png")
    plt.show()

    fig ,ax = plt.subplots(figsize = (14,8),)
    sns.lineplot(np.arange(200), rmse_icfn, label="I-CFN", ax=ax)
    sns.lineplot(np.arange(200), rmse_icfnpp, label="I-CFN-++", ax=ax)
    sns.lineplot(np.arange(200), rmse_icfnas, label="I-CFN-*", ax=ax)
    sns.lineplot(np.arange(200), rmse_ucfn, label="U-CFN", ax=ax)
    sns.lineplot(np.arange(200), rmse_ucfnpp, label="U-CFN-++", ax=ax)
    sns.lineplot(np.arange(200), rmse_ucfnas, label="U-CFN-*", ax=ax)

    min_val = min(min(rmse_ucfn), min(rmse_ucfnpp), min(rmse_ucfnas),
                  min(rmse_icfn), min(rmse_icfnpp), min(rmse_icfnas))
    sns.lineplot(np.arange(200), [min_val] * 200, label="Min-RMSE", ax=ax)
    sns.lineplot(np.arange(200), [0.9744] * 200, label="Popularity", ax=ax)

    ax.lines[6].set_linestyle("--")
    ax.lines[7].set_linestyle("--")



    ax.set_title("Test-RMSE MovieLens 1M")
    ax.set_xlabel("Epoch")
    ax.set_ylabel("RMSE")
    plt.savefig("i-u-cfn-comparison.png")
    plt.show()


    cold_rmse_icfn = [0.975740909576416, 0.9674053192138672, 0.9681292176246643, 0.9654054641723633, 0.9687002301216125, 0.9679883718490601, 0.9633877873420715, 0.9658931493759155, 0.9650315642356873, 0.9695725440979004, 0.9643641114234924, 0.9611769318580627, 0.9617739915847778, 0.9581286907196045, 0.9612033367156982, 0.954809308052063, 0.9523242712020874, 0.9532957673072815, 0.9507869482040405, 0.952483594417572, 0.9522316455841064, 0.9488725066184998, 0.9466094374656677, 0.9450434446334839, 0.9437376856803894, 0.9428514838218689, 0.9444891810417175, 0.9389387965202332, 0.9442785978317261, 0.9397140741348267, 0.9372828602790833, 0.9408003687858582, 0.9471530914306641, 0.9404105544090271, 0.9419557452201843, 0.9383102059364319, 0.9414611458778381, 0.9406672716140747, 0.9369467496871948, 0.9350597858428955, 0.9363393783569336, 0.9350615739822388, 0.9393200874328613, 0.9324156045913696, 0.940203070640564, 0.9373124241828918, 0.9381616711616516, 0.9375370740890503, 0.936333179473877, 0.9364403486251831, 0.939636766910553, 0.9312390089035034, 0.9319225549697876, 0.9349591732025146, 0.9354457259178162, 0.9295824766159058, 0.9355082511901855, 0.9308593273162842, 0.9333624839782715, 0.9301860332489014, 0.9334238767623901, 0.9326792359352112, 0.9364311695098877, 0.9314783215522766, 0.9336486458778381, 0.9332687854766846, 0.9300090074539185, 0.9320433735847473, 0.92873215675354, 0.9309571385383606, 0.934041440486908, 0.9301548004150391, 0.9334020614624023, 0.9333106279373169, 0.9317421317100525, 0.9322677254676819, 0.9307793378829956, 0.9288653135299683, 0.9282466769218445, 0.9286770820617676, 0.9309933185577393, 0.9277690052986145, 0.9320085048675537, 0.9294533729553223, 0.9266128540039062, 0.9277945160865784, 0.9323341250419617, 0.9295766353607178, 0.9278695583343506, 0.9293490052223206, 0.9293259978294373, 0.9252044558525085, 0.930702805519104, 0.9265503287315369, 0.9258042573928833, 0.934427797794342, 0.9302202463150024, 0.9285773038864136, 0.9291502833366394, 0.9278140664100647, 0.9291349649429321, 0.9294146299362183, 0.9322666525840759, 0.9256612062454224, 0.9344097971916199, 0.9279963970184326, 0.9248272180557251, 0.9245955348014832, 0.9260135293006897, 0.9313561916351318, 0.9260053634643555, 0.9252247214317322, 0.9343471527099609, 0.9247646927833557, 0.927781879901886, 0.9282655715942383, 0.9278191924095154, 0.9302875995635986, 0.9293829798698425, 0.9277958869934082, 0.9265991449356079, 0.9270690679550171, 0.9273568987846375, 0.9277659058570862, 0.9278040528297424, 0.9272869229316711, 0.9234605431556702, 0.9289807677268982, 0.9248270392417908, 0.9271112680435181, 0.9284286499023438, 0.9255310297012329, 0.9282432198524475, 0.9289200901985168, 0.9285532236099243, 0.9300956130027771, 0.9241244792938232, 0.9293944835662842, 0.9245204329490662, 0.925418496131897, 0.9297150373458862, 0.9269586205482483, 0.9280586242675781, 0.9237417578697205, 0.9236017465591431, 0.927439272403717, 0.9302775859832764, 0.9278462529182434, 0.9265586137771606, 0.929376482963562, 0.9239168763160706, 0.9267797470092773, 0.9257218241691589, 0.9250378608703613, 0.9261927008628845, 0.9302908778190613, 0.9248005747795105, 0.9246964454650879, 0.9269759058952332, 0.9269707798957825, 0.9259222745895386, 0.9260622262954712, 0.9250197410583496, 0.9244133830070496, 0.9259886145591736, 0.9299054741859436, 0.9251242876052856, 0.9233684539794922, 0.9240338802337646, 0.9246817231178284, 0.9268894195556641, 0.9286916255950928, 0.9297415614128113, 0.926460325717926, 0.9250434041023254, 0.9243689775466919, 0.9290268421173096, 0.928844153881073, 0.925243616104126, 0.9293459057807922, 0.9328671097755432, 0.9244741201400757, 0.9219995737075806, 0.9278683662414551, 0.9269026517868042, 0.928347110748291, 0.9271324276924133, 0.9272004961967468, 0.9279496073722839, 0.9274891018867493, 0.9275050759315491, 0.9260293841362, 0.9238355159759521, 0.9270830154418945, 0.9268405437469482, 0.9244254231452942, 0.9272232055664062, 0.9318299889564514, 0.9278345108032227, 0.9238563776016235]
    cold_rmse_icfnpp = [0.9721123576164246, 0.9668318033218384, 0.9671384692192078, 0.9621954560279846, 0.9645712375640869, 0.9645742177963257, 0.9666404128074646, 0.9623261094093323, 0.9629334807395935, 0.9624761939048767, 0.9616515636444092, 0.9581412672996521, 0.9576820731163025, 0.9528705477714539, 0.95315021276474, 0.9503490924835205, 0.9493667483329773, 0.9495053291320801, 0.9460626840591431, 0.9465301036834717, 0.9421290755271912, 0.9420969486236572, 0.9402640461921692, 0.9469186663627625, 0.9418330788612366, 0.9443911910057068, 0.94287109375, 0.9366875886917114, 0.9356511831283569, 0.9363126754760742, 0.9370778203010559, 0.9346194863319397, 0.934471070766449, 0.939062237739563, 0.9313340783119202, 0.9353285431861877, 0.9323245286941528, 0.9347566366195679, 0.9342438578605652, 0.932831346988678, 0.9303157925605774, 0.9310254454612732, 0.9311327338218689, 0.9321430921554565, 0.9317303895950317, 0.9351547956466675, 0.9298485517501831, 0.9311891794204712, 0.9323717355728149, 0.9318621754646301, 0.9273788332939148, 0.9289124608039856, 0.9296691417694092, 0.9278846383094788, 0.9344565868377686, 0.9278589487075806, 0.9282020926475525, 0.9306818246841431, 0.929656445980072, 0.9247622489929199, 0.9290264248847961, 0.9237273335456848, 0.9284725785255432, 0.9289436936378479, 0.9282005429267883, 0.9239335060119629, 0.9251778721809387, 0.9272412657737732, 0.9237255454063416, 0.9246259331703186, 0.9230377078056335, 0.9268354177474976, 0.9269394874572754, 0.9224306344985962, 0.9278556704521179, 0.9268054962158203, 0.924568772315979, 0.9243988990783691, 0.9222728610038757, 0.9257997274398804, 0.92120760679245, 0.9216641783714294, 0.9207859039306641, 0.9278569221496582, 0.9248520135879517, 0.9281824231147766, 0.9235950112342834, 0.9287312030792236, 0.9235923886299133, 0.9180488586425781, 0.9199074506759644, 0.92214435338974, 0.9215399622917175, 0.9210845232009888, 0.9251655340194702, 0.9212253093719482, 0.9230831265449524, 0.9228700399398804, 0.9246006608009338, 0.9192190170288086, 0.9240270853042603, 0.9232895970344543, 0.9225430488586426, 0.9227946996688843, 0.9221220016479492, 0.9208059906959534, 0.9195759892463684, 0.9232496023178101, 0.9222623705863953, 0.919657289981842, 0.9214531779289246, 0.9221691489219666, 0.9234036207199097, 0.9184854030609131, 0.920789897441864, 0.9192414283752441, 0.9245430827140808, 0.9185988306999207, 0.9164552092552185, 0.9218352437019348, 0.9190387725830078, 0.9208804368972778, 0.9220640063285828, 0.9180540442466736, 0.9174054861068726, 0.9208518862724304, 0.9211719632148743, 0.9215049147605896, 0.9194647669792175, 0.9226160049438477, 0.9205110669136047, 0.9187736511230469, 0.9204597473144531, 0.9243144989013672, 0.9234614372253418, 0.9185059070587158, 0.9184883236885071, 0.9186543822288513, 0.9189545512199402, 0.9219695925712585, 0.9208826422691345, 0.9183810949325562, 0.9207509756088257, 0.9180949330329895, 0.9172020554542542, 0.9167159199714661, 0.9213335514068604, 0.9212830066680908, 0.920648455619812, 0.9219903945922852, 0.9212180376052856, 0.916793942451477, 0.9203656911849976, 0.9142914414405823, 0.9187929630279541, 0.9174180626869202, 0.9166536331176758, 0.918588399887085, 0.922147274017334, 0.9185755848884583, 0.9207336902618408, 0.918127179145813, 0.9214555025100708, 0.9203464984893799, 0.9201998710632324, 0.918880045413971, 0.9135401844978333, 0.9188758730888367, 0.9184364676475525, 0.9180947542190552, 0.9174878597259521, 0.9186313152313232, 0.9216182827949524, 0.920961320400238, 0.9253169298171997, 0.9241437315940857, 0.9191532731056213, 0.9165887236595154, 0.9186492562294006, 0.9216273427009583, 0.9216315746307373, 0.9175209403038025, 0.9202785491943359, 0.9181472659111023, 0.9190303683280945, 0.918756902217865, 0.9195343852043152, 0.913734495639801, 0.9155029058456421, 0.9200323224067688, 0.9212308526039124, 0.9163424372673035, 0.916534423828125, 0.9199841022491455, 0.9202198386192322, 0.9181644916534424, 0.9220391511917114, 0.9147510528564453, 0.917194128036499, 0.9172245264053345]
    cold_rmse_icfnas = [1.4458025693893433, 1.1041617393493652, 1.0579041242599487, 1.017259955406189, 1.0108529329299927, 1.0675101280212402, 1.0232237577438354, 0.9997754693031311, 0.9968114495277405, 0.9921987652778625, 0.9879208207130432, 0.9818404316902161, 0.989618182182312, 0.9909824132919312, 0.9896295666694641, 0.9845954179763794, 0.9867344498634338, 0.9945564270019531, 0.9728558659553528, 0.9785290956497192, 0.9789300560951233, 0.9710856080055237, 0.9805703163146973, 0.9735584259033203, 0.972874104976654, 0.97684645652771, 0.9739165902137756, 0.9704681038856506, 0.9672310948371887, 0.9689310193061829, 0.9715589880943298, 0.9670247435569763, 0.972690224647522, 0.9695090055465698, 0.9665510654449463, 0.9726039171218872, 0.9687854051589966, 0.9654810428619385, 0.9672452807426453, 0.9702280759811401, 0.9729658365249634, 0.9686793684959412, 0.9670256972312927, 0.9716665744781494, 0.9669336676597595, 0.9680466651916504, 0.9662853479385376, 0.9670900106430054, 0.9657054543495178, 0.9695019125938416, 0.9612863063812256, 0.9637517929077148, 0.9600921273231506, 0.9598621726036072, 0.9606420397758484, 0.9676318168640137, 0.9623361229896545, 0.9599825739860535, 0.9603705406188965, 0.9630197286605835, 0.9633850455284119, 0.9625787734985352, 0.9614966511726379, 0.9619470834732056, 0.9567579030990601, 0.957166850566864, 0.9593938589096069, 0.9576693773269653, 0.9584075808525085, 0.9611552357673645, 0.9592412710189819, 0.9525752067565918, 0.9592829942703247, 0.9545730352401733, 0.9609127640724182, 0.9579674601554871, 0.9570836424827576, 0.9562729597091675, 0.9566891193389893, 0.9570589661598206, 0.9613014459609985, 0.9541581869125366, 0.9575895667076111, 0.9542467594146729, 0.9535768628120422, 0.9556846022605896, 0.9532231092453003, 0.9575051069259644, 0.9530131816864014, 0.9525114297866821, 0.9523094892501831, 0.9521307349205017, 0.9536070227622986, 0.9538935422897339, 0.9531331062316895, 0.952873945236206, 0.9504750967025757, 0.9489694237709045, 0.949917197227478, 0.9490606188774109, 0.9462383389472961, 0.9477308988571167, 0.9495190978050232, 0.9481483697891235, 0.9491803646087646, 0.9520837068557739, 0.9504730105400085, 0.944034218788147, 0.9442353248596191, 0.9451911449432373, 0.9445233941078186, 0.9459614753723145, 0.9477671384811401, 0.9463819861412048, 0.943649172782898, 0.9433118104934692, 0.9423606395721436, 0.9483326077461243, 0.9433114528656006, 0.9434816241264343, 0.9403500556945801, 0.9437358379364014, 0.9358869194984436, 0.9408490657806396, 0.9427592158317566, 0.9383109211921692, 0.9421678185462952, 0.9364485740661621, 0.9390082359313965, 0.9383078217506409, 0.9333903789520264, 0.9312310218811035, 0.9356182217597961, 0.9345756769180298, 0.9370898008346558, 0.9311201572418213, 0.9368067383766174, 0.9315988421440125, 0.9319425821304321, 0.9349488615989685, 0.9276582598686218, 0.9242343902587891, 0.9268642067909241, 0.9307756423950195, 0.9277722835540771, 0.9295716881752014, 0.9286035895347595, 0.9277903437614441, 0.9272060990333557, 0.9276376366615295, 0.9272429943084717, 0.9271189570426941, 0.9252400398254395, 0.9255908727645874, 0.9293739199638367, 0.9250458478927612, 0.92501300573349, 0.9250103831291199, 0.9263399243354797, 0.9265077710151672, 0.9289383292198181, 0.9253665208816528, 0.9250444769859314, 0.9230060577392578, 0.9254691004753113, 0.9264644980430603, 0.9240992069244385, 0.9240955114364624, 0.925710141658783, 0.9250047206878662, 0.9243842363357544, 0.9242791533470154, 0.9278193712234497, 0.9247377514839172, 0.9252210259437561, 0.9246360063552856, 0.9247886538505554, 0.9246078729629517, 0.9254355430603027, 0.9235772490501404, 0.9236589670181274, 0.9257876873016357, 0.9289825558662415, 0.9234141707420349, 0.9261428713798523, 0.9239863753318787, 0.9252942800521851, 0.925591230392456, 0.9249055981636047, 0.9219738245010376, 0.9261441230773926, 0.9241324067115784, 0.9240499138832092, 0.9260529279708862, 0.9259595274925232, 0.9240729212760925, 0.9244561791419983, 0.9240400791168213, 0.9226554036140442, 0.9234951734542847]
    cold_rmse_ucfn = [0.9928442239761353, 0.9883540868759155, 0.9872125387191772, 0.9846922159194946, 0.9841682314872742, 0.9854305386543274, 0.9823523759841919, 0.983448326587677, 0.9820622801780701, 0.9811704754829407, 0.9794423580169678, 0.9797253012657166, 0.9791614413261414, 0.9754173159599304, 0.9776142239570618, 0.9756080508232117, 0.9733037948608398, 0.9722602963447571, 0.9735797047615051, 0.9710420966148376, 0.9725465774536133, 0.9706965088844299, 0.9703488349914551, 0.9676722884178162, 0.9718192219734192, 0.9721232652664185, 0.9704872965812683, 0.9710146188735962, 0.9704139232635498, 0.9715262651443481, 0.966956615447998, 0.9694566130638123, 0.9706283807754517, 0.965087354183197, 0.964984118938446, 0.9627021551132202, 0.97042316198349, 0.9681348204612732, 0.9650096297264099, 0.9688902497291565, 0.9638478755950928, 0.9663230776786804, 0.9678202867507935, 0.9634354114532471, 0.9644463062286377, 0.9632591009140015, 0.967174232006073, 0.9605228304862976, 0.9615566730499268, 0.9601335525512695, 0.9623391032218933, 0.9592413902282715, 0.9630047678947449, 0.9635628461837769, 0.9616072177886963, 0.9610947966575623, 0.9675201177597046, 0.9555974006652832, 0.9593913555145264, 0.9552775025367737, 0.9590941667556763, 0.9636977910995483, 0.9650533199310303, 0.9642103314399719, 0.964040994644165, 0.9585540294647217, 0.961368978023529, 0.9615725874900818, 0.9624143838882446, 0.9579554200172424, 0.9569200277328491, 0.9590386152267456, 0.958184540271759, 0.9564257860183716, 0.9619694948196411, 0.960820734500885, 0.9577369093894958, 0.9578819870948792, 0.961496889591217, 0.9557239413261414, 0.9572171568870544, 0.9582287073135376, 0.9594979882240295, 0.9564017057418823, 0.9571399688720703, 0.9527033567428589, 0.961486279964447, 0.9555849432945251, 0.955058217048645, 0.9580597877502441, 0.9581095576286316, 0.9592171311378479, 0.9580366015434265, 0.9569345116615295, 0.9584061503410339, 0.9570086598396301, 0.9571094512939453, 0.9595444202423096, 0.955310046672821, 0.9616518616676331, 0.9576370120048523, 0.9580618143081665, 0.9563878774642944, 0.9590129256248474, 0.9586440324783325, 0.9564297199249268, 0.9589155316352844, 0.9556367993354797, 0.9541072845458984, 0.9573895335197449, 0.9619396328926086, 0.9608638882637024, 0.956671416759491, 0.955787181854248, 0.9579076170921326, 0.953728973865509, 0.9560179710388184, 0.9537176489830017, 0.962193489074707, 0.9562617540359497, 0.9536435008049011, 0.9531956911087036, 0.958533763885498, 0.9565605521202087, 0.9603301882743835, 0.9552462697029114, 0.9540773630142212, 0.9581956267356873, 0.9574382305145264, 0.9535028338432312, 0.9549978971481323, 0.9544891715049744, 0.9567880630493164, 0.9549380540847778, 0.9544126987457275, 0.9559581875801086, 0.956595778465271, 0.9544405341148376, 0.9577242732048035, 0.9565866589546204, 0.9565937519073486, 0.9534817934036255, 0.9545012712478638, 0.9554272294044495, 0.9575303196907043, 0.951712965965271, 0.9498042464256287, 0.9547746181488037, 0.9546024799346924, 0.9568338990211487, 0.9539323449134827, 0.9553385972976685, 0.9556739926338196, 0.9586325287818909, 0.9542225003242493, 0.9525557160377502, 0.9522427320480347, 0.9561218023300171, 0.9504923224449158, 0.9540203809738159, 0.9587845802307129, 0.956481397151947, 0.9515121579170227, 0.9575999975204468, 0.9574350118637085, 0.9546962380409241, 0.9560085535049438, 0.9514883160591125, 0.954634428024292, 0.9548609852790833, 0.9560673832893372, 0.9544822573661804, 0.9588124752044678, 0.9582962989807129, 0.9588040709495544, 0.9557950496673584, 0.9511353969573975, 0.9577482342720032, 0.958849310874939, 0.9543182849884033, 0.952349841594696, 0.9582743644714355, 0.9560775756835938, 0.9548070430755615, 0.953040361404419, 0.9548355340957642, 0.9572414755821228, 0.9515007138252258, 0.9576014280319214, 0.956631600856781, 0.9591823220252991, 0.9561778903007507, 0.9557641744613647, 0.9550238847732544, 0.9551346302032471, 0.957719624042511, 0.9540099501609802, 0.9622290134429932, 0.9530782103538513, 0.9605568051338196]
    cold_rmse_ucfnpp = [0.9952844381332397, 0.9867140054702759, 0.9861292839050293, 0.9861481785774231, 0.9846540689468384, 0.9832214713096619, 0.9808763265609741, 0.9823848009109497, 0.9810818433761597, 0.9802785515785217, 0.9795821309089661, 0.9783416986465454, 0.9781503677368164, 0.9769347310066223, 0.9750253558158875, 0.9759454131126404, 0.9756413698196411, 0.9734378457069397, 0.9731305241584778, 0.9738756418228149, 0.9710344076156616, 0.9694372415542603, 0.9712491631507874, 0.9670282602310181, 0.9700000882148743, 0.9679595828056335, 0.9692569375038147, 0.966464102268219, 0.9652683734893799, 0.9661654829978943, 0.9683666825294495, 0.9625909328460693, 0.9640678763389587, 0.9646769165992737, 0.9630250930786133, 0.9658206105232239, 0.9654239416122437, 0.9641661643981934, 0.966101348400116, 0.9619969725608826, 0.9630468487739563, 0.9610496759414673, 0.9585294723510742, 0.9604024291038513, 0.9639443159103394, 0.9614013433456421, 0.957553505897522, 0.9620445966720581, 0.9629799723625183, 0.9550774693489075, 0.9605336785316467, 0.9580132961273193, 0.9613519906997681, 0.962379515171051, 0.9585596323013306, 0.9608801007270813, 0.9575068950653076, 0.9573792815208435, 0.9557180404663086, 0.95417720079422, 0.9575247764587402, 0.9596660733222961, 0.9560981392860413, 0.9554088115692139, 0.9570187330245972, 0.9586490392684937, 0.9557549357414246, 0.9532666206359863, 0.9567928910255432, 0.95851069688797, 0.9515547752380371, 0.9569576978683472, 0.9586532115936279, 0.9554886221885681, 0.9614048004150391, 0.9532097578048706, 0.9560959339141846, 0.9589756727218628, 0.9562581777572632, 0.9565979242324829, 0.9534501433372498, 0.9567785263061523, 0.9534381031990051, 0.9552621841430664, 0.9502512216567993, 0.9538117051124573, 0.95695561170578, 0.9582220315933228, 0.9562451243400574, 0.9556575417518616, 0.9542690515518188, 0.9531595706939697, 0.9597585201263428, 0.9529642462730408, 0.9510574340820312, 0.9549024701118469, 0.9518119692802429, 0.9558234810829163, 0.9501780271530151, 0.9512341022491455, 0.9583749175071716, 0.9545426964759827, 0.9532714486122131, 0.9527941346168518, 0.9552488327026367, 0.9544190168380737, 0.953546404838562, 0.9520245790481567, 0.950160026550293, 0.9572876691818237, 0.9525343179702759, 0.9501641988754272, 0.9519473910331726, 0.956531822681427, 0.9574497938156128, 0.9529404640197754, 0.9545584917068481, 0.9531891942024231, 0.9559051990509033, 0.9553787708282471, 0.9544855952262878, 0.954383134841919, 0.9501777291297913, 0.9544852375984192, 0.951566219329834, 0.9518064260482788, 0.9517344832420349, 0.9546555280685425, 0.9525609612464905, 0.9501692652702332, 0.9552573561668396, 0.9537073969841003, 0.9545496702194214, 0.9515777230262756, 0.9514238834381104, 0.9488479495048523, 0.949937641620636, 0.9534875154495239, 0.9506849050521851, 0.9523791670799255, 0.9587711095809937, 0.9495446085929871, 0.9566442370414734, 0.955970287322998, 0.951477587223053, 0.9547998309135437, 0.9514067769050598, 0.9514886736869812, 0.9478145241737366, 0.9510446786880493, 0.9505057334899902, 0.9472807049751282, 0.951315701007843, 0.950246274471283, 0.9492256045341492, 0.952765166759491, 0.9512504935264587, 0.9532724618911743, 0.9541518688201904, 0.9540567398071289, 0.9505855441093445, 0.9518682360649109, 0.9535389542579651, 0.9529807567596436, 0.9532057642936707, 0.9524974226951599, 0.948746383190155, 0.9511169195175171, 0.9472166895866394, 0.9526229500770569, 0.9488827586174011, 0.9473309516906738, 0.9514008164405823, 0.954644501209259, 0.9526989459991455, 0.949627697467804, 0.9527940154075623, 0.9537044763565063, 0.9509940147399902, 0.9521996974945068, 0.9490618705749512, 0.9495550394058228, 0.9523543119430542, 0.9501729607582092, 0.9511811137199402, 0.9517910480499268, 0.9543179869651794, 0.9502862095832825, 0.9510291218757629, 0.9502671360969543, 0.9559552073478699, 0.9534224271774292, 0.9558505415916443, 0.951836884021759, 0.9507752656936646, 0.9484129548072815, 0.9503951072692871, 0.9511991143226624, 0.9494919180870056, 0.9499421119689941]
    cold_rmse_ucfnas = [1.2104061841964722, 1.0534251928329468, 1.048073172569275, 1.0043426752090454, 1.0176271200180054, 1.002944827079773, 0.9977655410766602, 0.9981235265731812, 0.9991642832756042, 0.9983978271484375, 0.9940215945243835, 0.9919970631599426, 0.9944978356361389, 0.9895906448364258, 0.988941490650177, 0.9970687031745911, 0.9865548014640808, 0.9906597137451172, 0.9897334575653076, 0.9865750074386597, 0.9900161027908325, 0.993290901184082, 0.986560046672821, 0.9879571199417114, 0.9905256032943726, 0.9886200428009033, 0.9878054261207581, 0.9918358325958252, 0.9892638921737671, 0.9857450723648071, 0.9814592003822327, 0.9816672205924988, 0.9767237305641174, 0.9810645580291748, 0.980141818523407, 0.9770826101303101, 0.9785584807395935, 0.9732143878936768, 0.9821726679801941, 0.9738137722015381, 0.9761815071105957, 0.9746735692024231, 0.9806606769561768, 0.9786337018013, 0.975351095199585, 0.9784705638885498, 0.9743181467056274, 0.9755554795265198, 0.9714286923408508, 0.9709349870681763, 0.9766326546669006, 0.9734061360359192, 0.9681661128997803, 0.9704700708389282, 0.981517493724823, 0.9717761874198914, 0.9679569005966187, 0.9704908728599548, 0.9692784547805786, 0.9682945609092712, 0.9678497910499573, 0.9675068855285645, 0.9693588018417358, 0.968634307384491, 0.9679375290870667, 0.9663090109825134, 0.9657541513442993, 0.966242790222168, 0.9635261297225952, 0.9665935635566711, 0.9636020064353943, 0.9620465040206909, 0.966517448425293, 0.9686042070388794, 0.9655269384384155, 0.964714765548706, 0.9673330783843994, 0.9675710201263428, 0.9635801315307617, 0.9653809070587158, 0.9637222290039062, 0.9700930118560791, 0.9635319709777832, 0.9640393853187561, 0.9628959894180298, 0.9699937701225281, 0.9621159434318542, 0.9618714451789856, 0.9648313522338867, 0.9624635577201843, 0.9588120579719543, 0.9577357172966003, 0.9615272879600525, 0.963520884513855, 0.9578670859336853, 0.966471791267395, 0.9624011516571045, 0.9620248079299927, 0.9644075632095337, 0.9668419361114502, 0.9580236673355103, 0.9633811712265015, 0.9665943384170532, 0.9648156762123108, 0.9606704711914062, 0.9602802395820618, 0.9597327709197998, 0.9627847671508789, 0.9605540037155151, 0.95657879114151, 0.9574096202850342, 0.9572467803955078, 0.9603899121284485, 0.9578150510787964, 0.9600778818130493, 0.9597135186195374, 0.9584113359451294, 0.962142825126648, 0.9607598781585693, 0.9629446268081665, 0.9555881023406982, 0.9587095975875854, 0.9647657871246338, 0.9589742422103882, 0.9561763405799866, 0.9585937857627869, 0.955600380897522, 0.9571138024330139, 0.9567642211914062, 0.9575347304344177, 0.9599477648735046, 0.9608216285705566, 0.9591568112373352, 0.9693478345870972, 0.9621043801307678, 0.9604146480560303, 0.9556999802589417, 0.959994912147522, 0.9597424268722534, 0.9558954834938049, 0.9560271501541138, 0.9521039128303528, 0.960769534111023, 0.9576526880264282, 0.9544767141342163, 0.9567558765411377, 0.9553044438362122, 0.9593625664710999, 0.9579713940620422, 0.9565244317054749, 0.9607589244842529, 0.9520948529243469, 0.953882098197937, 0.9545326232910156, 0.9553024172782898, 0.9528989195823669, 0.9581261277198792, 0.952646791934967, 0.9571064114570618, 0.9538159370422363, 0.9548243284225464, 0.957099974155426, 0.964070200920105, 0.9541553854942322, 0.9575403332710266, 0.9485092163085938, 0.9548159837722778, 0.9534618258476257, 0.9546578526496887, 0.9490432143211365, 0.9520390629768372, 0.9595836400985718, 0.9504004716873169, 0.9639812111854553, 0.9532293081283569, 0.948991060256958, 0.9576424956321716, 0.9534919261932373, 0.9526641368865967, 0.9544982314109802, 0.9531068205833435, 0.958911657333374, 0.9534224271774292, 0.9544010162353516, 0.9503503441810608, 0.9541155695915222, 0.953956127166748, 0.9575732350349426, 0.9573660492897034, 0.9539111256599426, 0.9538804888725281, 0.9512637853622437, 0.9594517350196838, 0.9737645387649536, 0.9528316259384155, 0.9540441036224365, 0.9518408179283142, 0.9520600438117981, 0.9514492154121399, 0.9535709023475647, 0.9563595652580261, 0.9504030346870422, 0.9572566747665405, 0.9562659859657288, 0.9549553394317627, 0.952288031578064, 0.9582445025444031, 0.9574165940284729, 0.9564672708511353, 0.9570540189743042, 0.9520108699798584, 0.9520941376686096, 0.9535126090049744, 0.9509789347648621, 0.9539916515350342, 0.9511091113090515, 0.9539748430252075, 0.9512999653816223, 0.9567843079566956, 0.9541659355163574, 0.9545706510543823, 0.953652024269104, 0.9550310373306274, 0.9541506767272949, 0.9556046724319458, 0.9575640559196472, 0.9504451751708984, 0.9557189345359802, 0.9532828330993652, 0.954028844833374, 0.9528996348381042, 0.9530368447303772, 0.9554766416549683, 0.9586862325668335, 0.954025387763977, 0.960720419883728, 0.9603345990180969, 0.9551800489425659, 0.956587016582489, 0.9555090069770813, 0.9516858458518982, 0.948857843875885, 0.9530172348022461, 0.9534279108047485, 0.9512171745300293, 0.9515179395675659, 0.9550216197967529, 0.9539894461631775, 0.9549364447593689, 0.9541213512420654][:200]

    fig ,ax = plt.subplots(figsize = (14,8),)
    sns.lineplot(np.arange(200), cold_rmse_icfn, label="I-CFN", ax=ax)
    sns.lineplot(np.arange(200), cold_rmse_icfnpp, label="I-CFN-++", ax=ax)
    sns.lineplot(np.arange(200), cold_rmse_icfnas, label="I-CFN-*", ax=ax)
    sns.lineplot(np.arange(200), cold_rmse_ucfn, label="U-CFN", ax=ax)
    sns.lineplot(np.arange(200), cold_rmse_ucfnpp, label="U-CFN-++", ax=ax)
    sns.lineplot(np.arange(200), cold_rmse_ucfnas, label="U-CFN-*", ax=ax)
    min_val = min(min(cold_rmse_ucfn), min(cold_rmse_ucfnpp), min(cold_rmse_ucfnas),
                  min(cold_rmse_icfn), min(cold_rmse_icfnpp), min(cold_rmse_icfnas))
    sns.lineplot(np.arange(200), [min_val] * 200, label="Min-RMSE", ax=ax)
    sns.lineplot(np.arange(200), [1.004] * 200, label="Popularity", ax=ax)

    ax.lines[6].set_linestyle("--")
    ax.lines[7].set_linestyle("--")

    ax.set_title("Test-RMSE MovieLens 1M - Cold ratings")
    ax.set_xlabel("Epoch")
    ax.set_ylabel("RMSE")
    plt.savefig("cold-i-u-cfn-comparison.png")
    plt.show()



    fig ,ax = plt.subplots(figsize = (14,8),)
    sns.lineplot(np.arange(200), cold_rmse_ucfn, label="U-CFN", ax=ax)
    sns.lineplot(np.arange(200), cold_rmse_ucfnpp, label="U-CFN-++", ax=ax)
    sns.lineplot(np.arange(200), cold_rmse_ucfnas, label="U-CFN-*", ax=ax)
    min_val = min(min(cold_rmse_ucfn), min(cold_rmse_ucfnpp), min(cold_rmse_ucfnas))
    sns.lineplot(np.arange(200), [min_val] * 200, label="Min-RMSE", ax=ax)
    ax.set_title("Test-RMSE Cold ratings")
    ax.set_xlabel("Epoch")
    ax.set_ylabel("RMSE")
    plt.savefig("cold-u-cfn-comparison.png")
    plt.show()

    fig ,ax = plt.subplots(figsize = (14,8),)
    sns.lineplot(np.arange(200), cold_rmse_icfn, label="I-CFN", ax=ax)
    sns.lineplot(np.arange(200), cold_rmse_icfnpp, label="I-CFN-++", ax=ax)
    sns.lineplot(np.arange(200), cold_rmse_icfnas, label="I-CFN-*", ax=ax)
    min_val = min(min(cold_rmse_icfn), min(cold_rmse_icfnpp), min(cold_rmse_icfnas))
    sns.lineplot(np.arange(200), [min_val] * 200, label="Min-RMSE", ax=ax)
    ax.set_title("Test-RMSE Cold ratings")
    ax.set_xlabel("Epoch")
    ax.set_ylabel("RMSE")
    plt.savefig("cold-i-cfn-comparison.png")
    plt.show()